# ğŸš€ å®¡è®¡åº•ç¨¿å¼•æ“ - éƒ¨ç½²æŒ‡å—

**ç‰ˆæœ¬**: v0.9.0-beta  
**æ—¥æœŸ**: 2025-12-01  
**çŠ¶æ€**: Betaå°±ç»ª

---

## ğŸ“‹ éƒ¨ç½²å‡†å¤‡

### ç³»ç»Ÿè¦æ±‚

**ç¡¬ä»¶è¦æ±‚**:
```
CPU:     2æ ¸å¿ƒä»¥ä¸Š
å†…å­˜:    4GBä»¥ä¸Š (æ¨è8GB)
ç¡¬ç›˜:    20GBä»¥ä¸Šå¯ç”¨ç©ºé—´
ç½‘ç»œ:    ç¨³å®šçš„äº’è”ç½‘è¿æ¥
```

**è½¯ä»¶è¦æ±‚**:
```
Docker:          20.10+
Docker Compose:  2.0+
```

**å¯é€‰**:
```
Node.js:    18+ (æœ¬åœ°å¼€å‘)
PostgreSQL: 15+ (ç‹¬ç«‹éƒ¨ç½²)
Redis:      7+ (ç‹¬ç«‹éƒ¨ç½²)
```

---

## ğŸ³ Dockeréƒ¨ç½² (æ¨è)

### å¿«é€Ÿéƒ¨ç½² (5åˆ†é’Ÿ)

**1. å…‹éš†ä»£ç **
```bash
git clone https://github.com/your-org/audit-engine.git
cd audit-engine
```

**2. é…ç½®ç¯å¢ƒå˜é‡**
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘é…ç½®æ–‡ä»¶
vim .env
```

**å¿…é¡»ä¿®æ”¹çš„é…ç½®**:
```bash
# æ•°æ®åº“å¯†ç 
DB_PASSWORD=your_secure_password_here

# JWTå¯†é’¥ (ç”Ÿäº§ç¯å¢ƒå¿…é¡»ä¿®æ”¹!)
JWT_SECRET=your_very_secure_secret_key_min_32_chars

# Rediså¯†ç 
REDIS_PASSWORD=your_redis_password_here

# åŸŸåæˆ–IP
BASE_URL=https://your-domain.com
API_BASE_URL=https://your-domain.com/api
```

**3. å¯åŠ¨æœåŠ¡**
```bash
# æ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps
```

**4. éªŒè¯éƒ¨ç½²**
```bash
# æ£€æŸ¥åç«¯å¥åº·çŠ¶æ€
curl http://localhost:3000/health

# æ£€æŸ¥å‰ç«¯
curl http://localhost:80/

# æŸ¥çœ‹æ•°æ®åº“
docker-compose exec postgres psql -U postgres -d audit_engine
```

**5. è®¿é—®ç³»ç»Ÿ**
```
å‰ç«¯åœ°å€: http://localhost
åç«¯API: http://localhost:3000/api
é»˜è®¤è´¦å·: admin / admin123
```

---

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

**1. å‡†å¤‡SSLè¯ä¹¦**
```bash
# ä½¿ç”¨ Let's Encrypt
certbot certonly --standalone -d your-domain.com

# æˆ–ä½¿ç”¨å·²æœ‰è¯ä¹¦
mkdir -p ssl
cp your-cert.pem ssl/cert.pem
cp your-key.pem ssl/key.pem
```

**2. ä¿®æ”¹ docker-compose.yml**
```yaml
services:
  frontend:
    ports:
      - "443:443"
      - "80:80"
    volumes:
      - ./ssl:/etc/nginx/ssl
      - ./nginx.prod.conf:/etc/nginx/conf.d/default.conf
```

**3. é…ç½®nginx SSL**

åˆ›å»º `nginx.prod.conf`:
```nginx
server {
    listen 80;
    server_name your-domain.com;
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name your-domain.com;

    ssl_certificate /etc/nginx/ssl/cert.pem;
    ssl_certificate_key /etc/nginx/ssl/key.pem;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;

    # ... å…¶ä»–é…ç½®
}
```

**4. å¯åŠ¨ç”Ÿäº§æœåŠ¡**
```bash
docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d
```

---

## ğŸ’¾ æ•°æ®åº“åˆå§‹åŒ–

### è‡ªåŠ¨åˆå§‹åŒ– (Docker)

Dockerå¯åŠ¨æ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œæ•°æ®åº“è¿ç§»:
```bash
# æŸ¥çœ‹è¿ç§»æ—¥å¿—
docker-compose logs backend | grep migrate
```

### æ‰‹åŠ¨åˆå§‹åŒ–

```bash
# è¿›å…¥åç«¯å®¹å™¨
docker-compose exec backend sh

# è¿è¡Œè¿ç§»
npx prisma migrate deploy

# ç”ŸæˆPrisma Client
npx prisma generate

# å¡«å……åˆå§‹æ•°æ® (å¯é€‰)
npx prisma db seed
```

### åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·

```bash
# è¿›å…¥æ•°æ®åº“
docker-compose exec postgres psql -U postgres -d audit_engine

# æ‰§è¡ŒSQL
INSERT INTO "User" (id, username, password, email, role, "createdAt", "updatedAt")
VALUES (
  gen_random_uuid(),
  'admin',
  '$2b$10$...',  -- ä½¿ç”¨bcryptåŠ å¯†çš„å¯†ç 
  'admin@example.com',
  'ADMIN',
  NOW(),
  NOW()
);
```

---

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡è¯¦è§£

**æ•°æ®åº“é…ç½®**:
```bash
DB_NAME=audit_engine          # æ•°æ®åº“åç§°
DB_USER=postgres              # æ•°æ®åº“ç”¨æˆ·
DB_PASSWORD=postgres          # æ•°æ®åº“å¯†ç 
DB_PORT=5432                  # æ•°æ®åº“ç«¯å£
```

**Redisé…ç½®**:
```bash
REDIS_PASSWORD=redis123       # Rediså¯†ç 
REDIS_PORT=6379              # Redisç«¯å£
```

**åç«¯é…ç½®**:
```bash
NODE_ENV=production           # ç¯å¢ƒ: development/production
BACKEND_PORT=3000            # åç«¯ç«¯å£
JWT_SECRET=your-secret-key   # JWTå¯†é’¥
JWT_EXPIRES_IN=7d            # Tokenè¿‡æœŸæ—¶é—´
UPLOAD_DIR=./uploads         # æ–‡ä»¶ä¸Šä¼ ç›®å½•
BASE_URL=http://localhost:3000  # åç«¯URL
```

**å‰ç«¯é…ç½®**:
```bash
FRONTEND_PORT=80             # å‰ç«¯ç«¯å£
API_BASE_URL=http://localhost:3000/api  # APIåœ°å€
```

---

## ğŸ“Š ç›‘æ§å’Œæ—¥å¿—

### æŸ¥çœ‹æ—¥å¿—

**æ‰€æœ‰æœåŠ¡æ—¥å¿—**:
```bash
docker-compose logs -f
```

**ç‰¹å®šæœåŠ¡æ—¥å¿—**:
```bash
# åç«¯æ—¥å¿—
docker-compose logs -f backend

# å‰ç«¯æ—¥å¿—
docker-compose logs -f frontend

# æ•°æ®åº“æ—¥å¿—
docker-compose logs -f postgres
```

**å¯¼å‡ºæ—¥å¿—**:
```bash
docker-compose logs > logs/$(date +%Y%m%d).log
```

### èµ„æºç›‘æ§

```bash
# æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨
docker stats

# æŸ¥çœ‹ç‰¹å®šå®¹å™¨
docker stats audit-engine-backend
```

### å¥åº·æ£€æŸ¥

```bash
# æ£€æŸ¥æ‰€æœ‰æœåŠ¡å¥åº·çŠ¶æ€
docker-compose ps

# æ‰‹åŠ¨å¥åº·æ£€æŸ¥
curl http://localhost:3000/health
curl http://localhost:80/health
```

---

## ğŸ”„ æ›´æ–°å’Œç»´æŠ¤

### æ›´æ–°åº”ç”¨

```bash
# 1. æ‹‰å–æœ€æ–°ä»£ç 
git pull origin main

# 2. é‡æ–°æ„å»º
docker-compose build

# 3. åœæ­¢æ—§æœåŠ¡
docker-compose down

# 4. å¯åŠ¨æ–°æœåŠ¡
docker-compose up -d

# 5. è¿è¡Œæ•°æ®åº“è¿ç§»
docker-compose exec backend npx prisma migrate deploy
```

### æ•°æ®å¤‡ä»½

**æ•°æ®åº“å¤‡ä»½**:
```bash
# å¤‡ä»½
docker-compose exec postgres pg_dump -U postgres audit_engine > backup_$(date +%Y%m%d).sql

# æ¢å¤
docker-compose exec -T postgres psql -U postgres audit_engine < backup_20251201.sql
```

**æ–‡ä»¶å¤‡ä»½**:
```bash
# å¤‡ä»½ä¸Šä¼ æ–‡ä»¶
tar -czf uploads_backup_$(date +%Y%m%d).tar.gz uploads/

# æ¢å¤
tar -xzf uploads_backup_20251201.tar.gz
```

**å®Œæ•´å¤‡ä»½**:
```bash
# åœæ­¢æœåŠ¡
docker-compose down

# å¤‡ä»½æ•°æ®å·
docker run --rm -v audit-engine_postgres_data:/data -v $(pwd):/backup alpine tar -czf /backup/data_backup_$(date +%Y%m%d).tar.gz /data

# å¯åŠ¨æœåŠ¡
docker-compose up -d
```

---

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜

**1. å®¹å™¨æ— æ³•å¯åŠ¨**
```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯
docker-compose logs backend

# æ£€æŸ¥ç«¯å£å ç”¨
netstat -tulpn | grep :3000

# é‡ç½®å®¹å™¨
docker-compose down -v
docker-compose up -d
```

**2. æ•°æ®åº“è¿æ¥å¤±è´¥**
```bash
# æ£€æŸ¥æ•°æ®åº“çŠ¶æ€
docker-compose ps postgres

# æŸ¥çœ‹æ•°æ®åº“æ—¥å¿—
docker-compose logs postgres

# æµ‹è¯•è¿æ¥
docker-compose exec backend npx prisma db push
```

**3. å‰ç«¯æ— æ³•è®¿é—®åç«¯**
```bash
# æ£€æŸ¥ç½‘ç»œ
docker network ls
docker network inspect audit-engine_audit-network

# æ£€æŸ¥nginxé…ç½®
docker-compose exec frontend nginx -t

# é‡æ–°åŠ è½½nginx
docker-compose exec frontend nginx -s reload
```

**4. æ–‡ä»¶ä¸Šä¼ å¤±è´¥**
```bash
# æ£€æŸ¥ä¸Šä¼ ç›®å½•æƒé™
docker-compose exec backend ls -la /app/uploads

# ä¿®å¤æƒé™
docker-compose exec backend chmod 777 /app/uploads
```

---

## ğŸ”’ å®‰å…¨é…ç½®

### åŸºæœ¬å®‰å…¨æªæ–½

**1. ä¿®æ”¹é»˜è®¤å¯†ç **
```bash
# ä¿®æ”¹æ‰€æœ‰é»˜è®¤å¯†ç 
DB_PASSWORD=your_complex_password_123!
REDIS_PASSWORD=your_redis_password_456!
JWT_SECRET=your_very_secure_and_long_secret_key_789!
```

**2. é™åˆ¶ç½‘ç»œè®¿é—®**
```yaml
# docker-compose.yml
services:
  postgres:
    # ä¸æš´éœ²åˆ°å®¿ä¸»æœº
    # ports:
    #   - "5432:5432"
```

**3. å¯ç”¨é˜²ç«å¢™**
```bash
# Ubuntu/Debian
ufw allow 80/tcp
ufw allow 443/tcp
ufw enable
```

**4. å®šæœŸæ›´æ–°**
```bash
# æ›´æ–°Dockeré•œåƒ
docker-compose pull
docker-compose up -d
```

---

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

### æ•°æ®åº“ä¼˜åŒ–

```sql
-- postgresql.conf ä¼˜åŒ–
shared_buffers = 256MB
effective_cache_size = 1GB
work_mem = 16MB
maintenance_work_mem = 128MB
max_connections = 100
```

### Redisä¼˜åŒ–

```bash
# redis.conf
maxmemory 512mb
maxmemory-policy allkeys-lru
```

### Nginxä¼˜åŒ–

```nginx
# workerè¿›ç¨‹æ•°
worker_processes auto;

# è¿æ¥æ•°
worker_connections 1024;

# ç¼“å­˜
proxy_cache_path /var/cache/nginx levels=1:2 keys_zone=my_cache:10m;
```

---

## ğŸ¯ æµ‹è¯•éƒ¨ç½²

### å†’çƒŸæµ‹è¯•

```bash
# 1. å¥åº·æ£€æŸ¥
curl http://localhost:3000/health
# é¢„æœŸ: {"status":"healthy"}

# 2. APIæµ‹è¯•
curl http://localhost:3000/api/
# é¢„æœŸ: APIæ–‡æ¡£é¡µé¢

# 3. ç™»å½•æµ‹è¯•
curl -X POST http://localhost:3000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"admin123"}'
# é¢„æœŸ: {"success":true,"data":{"token":"..."}}

# 4. å‰ç«¯æµ‹è¯•
curl http://localhost:80/
# é¢„æœŸ: HTMLé¡µé¢
```

---

## ğŸ“ è·å–å¸®åŠ©

### é—®é¢˜åé¦ˆ

- GitHub Issues: https://github.com/your-org/audit-engine/issues
- Email: support@your-domain.com
- æ–‡æ¡£: https://docs.your-domain.com

### å¸¸ç”¨å‘½ä»¤

```bash
# å¯åŠ¨æœåŠ¡
docker-compose up -d

# åœæ­¢æœåŠ¡
docker-compose down

# é‡å¯æœåŠ¡
docker-compose restart

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f

# è¿›å…¥å®¹å™¨
docker-compose exec backend sh

# æ¸…ç†èµ„æº
docker-compose down -v --rmi all
```

---

**éƒ¨ç½²æŒ‡å—ç‰ˆæœ¬**: v1.0  
**æœ€åæ›´æ–°**: 2025-12-01  
**ç»´æŠ¤è€…**: å¼€å‘å›¢é˜Ÿ

ğŸš€ **ç¥æ‚¨éƒ¨ç½²é¡ºåˆ©ï¼**
